<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Mini City Life</title>
<body>
  <canvas id="game"></canvas>
</body>
<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  touch-action:none;
  font-family:Arial;
}
#hud{
  position:fixed;
  top:10px;
  left:10px;
  background:rgba(0,0,0,0.65);
  color:#fff;
  padding:10px;
  border-radius:8px;
  z-index:100;
}
#fuelBar{
  width:120px;
  height:10px;
  background:#444;
  margin-top:5px;
}
#fuel{
  height:10px;
  background:lime;
  width:100%;
}
#modeBtn{
  position:fixed;
  bottom:20px;
  left:20px;
  padding:12px;
  background:#000;
  color:#fff;
  border-radius:8px;
  z-index:100;
}

#world{
  position:relative;
  width:2600px;
  height:2600px;
  background:#4caf50;
  transition:filter 1s;
}

.road{position:absolute;background:#333;}
.h{width:2600px;height:90px;}
.v{width:90px;height:2600px;}

#player{
  position:absolute;
  width:48px;
  height:48px;
  background-size:cover;
  z-index:10;
}

.coin{
  position:absolute;
  width:22px;
  height:22px;
  background:url("https://i.imgur.com/O7RZ0nG.png");
  background-size:cover;
}

.station{
  position:absolute;
  width:60px;
  height:60px;
  background:url("https://i.imgur.com/8FQyKQF.png");
  background-size:cover;
}

.npc{
  position:absolute;
  width:40px;
  height:40px;
  background:url("https://i.imgur.com/7QZ6F5L.png");
  background-size:cover;
}
</style>
</head>

<body>

<div id="hud">
  Coins: <span id="coins">0</span><br>
  Mission: <span id="mission">Collect 10 coins</span>
  <div id="fuelBar"><div id="fuel"></div></div>
</div>

<button id="modeBtn">üöó Enter Car</button>

<div id="world">
  <div id="player"></div>
</div>

<audio id="coinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-coin-216.wav"></audio>
<audio id="completeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.wav"></audio>

<script>
const world=document.getElementById("world");
const player=document.getElementById("player");
const coinsUI=document.getElementById("coins");
const missionUI=document.getElementById("mission");
const fuelUI=document.getElementById("fuel");
const modeBtn=document.getElementById("modeBtn");
const coinSound=document.getElementById("coinSound");
const completeSound=document.getElementById("completeSound");

let x=1300,y=1300,vx=0,vy=0;
let coins=0,fuel=100;
let mode="walk";
let missionTarget=10;

const sprites={
  walk:"https://i.imgur.com/YW7zZpK.png",
  car:"https://i.imgur.com/7QZ6F5L.png",
  plane:"https://i.imgur.com/Jy0ZK9N.png"
};

player.style.backgroundImage=`url(${sprites.walk})`;

for(let i=0;i<6;i++){
  let r=document.createElement("div");
  r.className="road h";
  r.style.top=(300+i*350)+"px";
  world.appendChild(r);
}
for(let i=0;i<6;i++){
  let r=document.createElement("div");
  r.className="road v";
  r.style.left=(300+i*350)+"px";
  world.appendChild(r);
}

function spawnCoin(){
  let c=document.createElement("div");
  c.className="coin";
  c.style.left=Math.random()*2400+"px";
  c.style.top=Math.random()*2400+"px";
  world.appendChild(c);
}
for(let i=0;i<15;i++)spawnCoin();

let station=document.createElement("div");
station.className="station";
station.style.left="1200px";
station.style.top="600px";
world.appendChild(station);

/* NPC traffic */
for(let i=0;i<6;i++){
  let n=document.createElement("div");
  n.className="npc";
  n.style.left=(400+i*300)+"px";
  n.style.top="350px";
  world.appendChild(n);
  let nx=400+i*300;
  setInterval(()=>{nx+=1;if(nx>2500)nx=0;n.style.left=nx+"px";},30);
}

let tx,ty;
document.addEventListener("touchstart",e=>{
  tx=e.touches[0].clientX;
  ty=e.touches[0].clientY;
});
document.addEventListener("touchmove",e=>{
  vx+=(e.touches[0].clientX-tx)*0.03;
  vy+=(e.touches[0].clientY-ty)*0.03;
  tx=e.touches[0].clientX;
  ty=e.touches[0].clientY;
});

let day=true;
setInterval(()=>{
  day=!day;
  world.style.filter=day?"brightness(1)":"brightness(0.6)";
},20000);

function update(){
  let max=mode==="walk"?2:mode==="car"?4:6;
  vx*=0.9;vy*=0.9;
  if(fuel>0){
    x+=Math.max(-max,Math.min(max,vx));
    y+=Math.max(-max,Math.min(max,vy));
    if(mode!=="walk")fuel-=0.02;
  }
  fuel=Math.max(0,fuel);
  fuelUI.style.width=fuel+"%";

  player.style.left=x+"px";
  player.style.top=y+"px";
  world.style.transform=`translate(${-x+innerWidth/2}px,${-y+innerHeight/2}px)`;

  document.querySelectorAll(".coin").forEach(c=>{
    if(Math.abs(x-c.offsetLeft)<30 && Math.abs(y-c.offsetTop)<30){
      c.remove();coins++;coinsUI.textContent=coins;
      coinSound.play();
      if(navigator.vibrate)navigator.vibrate(40);
      spawnCoin();
      if(coins>=missionTarget){
        completeSound.play();
        missionTarget+=10;
        missionUI.textContent="Collect "+missionTarget+" coins";
      }
    }
  });

  if(Math.abs(x-1200)<50 && Math.abs(y-600)<50){
    fuel=100;
  }
  requestAnimationFrame(update);
}
update();

modeBtn.onclick=()=>{
  if(mode==="walk"){mode="car";player.style.backgroundImage=`url(${sprites.car})`;modeBtn.textContent="‚úàÔ∏è Fly";}
  else if(mode==="car"){mode="plane";player.style.backgroundImage=`url(${sprites.plane})`;modeBtn.textContent="üö∂ Walk";}
  else{mode="walk";player.style.backgroundImage=`url(${sprites.walk})`;modeBtn.textContent="üöó Enter Car";}
};
</script>

</body>
  </html>
